<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">

    <title>ä»¿åˆ¶ç½‘æ˜“äº‘éŸ³ä¹ç½‘ç«™çš„è½®æ’­å›?/title>
    <!-- å¼•å…¥å­—ä½“å›¾æ ‡ -->
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./74.css">
</head>

<body>
    <!-- è½®æ’­å›¾ä¸»ä½?-->
    <div class="swipe" id="swipe">
        <!-- æ¨¡ç³ŠèƒŒæ™¯ -->
        <div class="bg" id="swipe_bg"></div>
        <!-- å›¾ç‰‡åŒºåŸŸ -->
        <section>
            <!-- å›¾ç‰‡æ˜¾ç¤º -->
            <div class="img-box" id="swipe_img_box">
                <a href="#" class="link" id="swipe_link">
                    <img src="../images/cloud_music/1.jpg" alt="" class="img" id="swipe_img">
                </a>
            </div>
            <!-- æŒ‡ç¤ºç‚?-->
            <div class="select" id="swipe_select">
                <!-- <a href="#" class="item checked"></a>
                <a href="#" class="item"></a>
                <a href="#" class="item"></a> -->
            </div>
            <!-- å·¦ä¾§ç¿»é¡µæŒ‰é’® -->
            <div class="btn left" id="swipe_btn_left">
                <!-- å­—ä½“å›¾æ ‡ï¼šå·¦ç®­å¤´ -->
                <i class="fa fa-angle-left" aria-hidden="true"></i>
            </div>
            <!-- å³ä¾§ç¿»é¡µæŒ‰é’® -->
            <div class="btn right" id="swipe_btn_right">
                <!-- å­—ä½“å›¾æ ‡ï¼šå³ç®­å¤´ -->
                <i class="fa fa-angle-right" aria-hidden="true"></i>
            </div>
        </section>
    </div>
    <script>
        // å½“å‰è½®æ’­å›¾ç¼–å?
        let current_index=-1;
        // è‡ªåŠ¨è½®æ’­å®šæ—¶å™?
        let swipe_timer=null;
        // è½®æ’­å›¾çš„å›¾ç‰‡åœ°å€ä¸è·³è½¬é“¾æ?
        let links=[
            {'image':'../images/cloud_music/1.jpg','target':'#1'},
            {'image':'../images/cloud_music/2.jpg','target':'#2'},
            {'image':'../images/cloud_music/3.jpg','target':'#3'},
            {'image':'../images/cloud_music/4.jpg','target':'#4'},
            {'image':'../images/cloud_music/5.jpg','target':'#5'},
            {'image':'../images/cloud_music/6.jpg','target':'#6'}
        ];

        // éœ€è¦æ“ä½œåˆ°çš„å…ƒç´?
        let swipe=document.getElementById('swipe');
        let swipe_bg=document.getElementById('swipe_bg');
        let swipe_img_box=document.getElementById('swipe_img_box');
        let swipe_link=document.getElementById('swipe_link');
        let swipe_img=document.getElementById('swipe_img');
        let swipe_select=document.getElementById('swipe_select');
        let swipe_btn_left=document.getElementById('swipe_btn_left');
        let swipe_btn_right=document.getElementById('swipe_btn_right');

        // äº‹ä»¶
        // åˆ‡æ¢å›¾ç‰‡
        let select=(index)=>{
            // åœæ­¢æ’­æ”¾
            stop();
            // è½¬æ•°å­?
            index=Number(index);
            // è¶Šç•Œè¶…è¿‡æœ€å¤§æ•°é‡?ç›´æ¥è¿”å›
            if(index>=links.length){
                return;
            }
            // é€‰ä¸­å½“å‰å·²é€‰ä¸­çš?ç›´æ¥è¿”å›
            if(current_index==index){
                return;
            }
            // å–æ¶ˆå½“å‰æŒ‡ç¤ºç‚¹çš„é€‰ä¸­çŠ¶æ€?
            if(current_index>-1){
                swipe_select.children[current_index].classList.remove('checked');
            }
            // å˜æ›´å½“å‰è½®æ’­å›¾çš„ç¼–å·
            current_index=index;
            // æ‰¾åˆ°å½“å‰å…ƒç´ 
            let current_link=links[current_index];
            // èƒŒæ™¯å˜åŒ–
            swipe_bg.style.backgroundImage='url('+current_link.image+')';
            // å‰æ™¯å˜åŒ–
            swipe_img.setAttribute('src',current_link.image);
            // é“¾æ¥å˜åŒ–
            swipe_link.setAttribute('href',current_link.target);
            // å¢åŠ æ–°çš„æŒ‡ç¤ºç‚¹çš„é€‰ä¸­çŠ¶æ€?
            swipe_select.children[current_index].classList.add('checked');
        };
        // è‡ªåŠ¨åˆ‡æ¢å›¾ç‰‡
        let autoSelect=(index)=>{
            // è½¬æ•°å­?
            index=Number(index);
            // è¶Šç•Œè¶…è¿‡æœ€å¤§æ•°é‡ï¼Œç›´æ¥è¿”å›
            if(index>=links.length){
                return;
            }
            // é€‰ä¸­å½“å‰å·²é€‰ä¸­çš„ï¼Œç›´æ¥è¿”å›
            if(current_index==index){
                return;
            }
            // å–æ¶ˆå½“å‰æŒ‡ç¤ºç‚¹çš„é€‰ä¸­çŠ¶æ€?
            swipe_select.children[current_index].classList.remove('checked');
            // å˜æ›´å½“å‰è½®æ’­å›¾çš„ç¼–å·
            current_index=index;
            // æ‰¾åˆ°å½“å‰å…ƒç´ 
            let current_link=links[current_index];
            // å‰æ™¯å›¾ç‰‡
            // ç¬¬ä¸€æ­¥è°ƒæ•´è¿‡æ¸¡æ—¶é—?
            swipe_img.style.transition='opacity 0.5s ease-in 0s';
            // ç¬¬äºŒæ­¥è°ƒæ•´ä¸é€æ˜åº¦ä¸º0.2
            swipe_img.style.opacity=0.2;
            // ç¬¬ä¸‰æ­¥å»¶è¿Ÿå˜æ¢imgå›¾ç‰‡ï¼Œå¹¶é‡æ–°å®šä¹‰é€æ˜åº¦ä»¥åŠè¿‡æ¸¡æ—¶é—´å’Œè¿‡æ¸¡æ–¹å¼
            setTimeout(() => {
                // èƒŒæ™¯å˜åŒ–
                swipe_bg.style.backgroundImage='url('+current_link.image+')';
                // å‰æ™¯å˜åŒ–
                swipe_img.setAttribute('src',current_link.image);
                // é“¾æ¥å˜åŒ–
                swipe_link.setAttribute('href',current_link.target);
                // ä¸é€æ˜åº¦å˜åŒ?
                swipe_img.style.transition='opacity 0.7s ease-out 0s';
                swipe_img.style.opacity=1;
                // å¢åŠ æ–°çš„æŒ‡ç¤ºç‚¹é€‰ä¸­çŠ¶æ€?
                // å¦‚æœå·²ç»é€šè¿‡æ‰‹åŠ¨ç‚¹å‡»äº†ï¼Œé€‰ä¸­åˆ™æ­¤å¤„ä¸å†æ‰§è¡?
                if(!document.querySelector('.swipe .checked')){
                    swipe_select.children[current_index].style.transition='background-color 0.5s';
                    swipe_select.children[current_index].classList.add('checked');
                }
            }, 500);
        };
        // æ’­æ”¾
        let play=()=>{
            // 3ç§’åˆ‡æ¢ä¸€æ¬?
            swipe_timer=setInterval(()=>{
                // è®¾ç½®æ–°çš„index
                let index=current_index+1;
                // å³ç¿»è¶Šç•Œï¼Œåˆ‡åˆ°ç¬¬ä¸€å¼?
                if(index>=links.length){
                    index=0;
                }
                // åŠ è½½æ–°å›¾ç‰‡ï¼ˆè¿™é‡Œé€‰æ‹©è‡ªåŠ¨ï¼Œå¢åŠ åˆ‡æ¢æ•ˆæœï¼‰
                autoSelect(index);
            },3000);
        };
        // åœæ­¢
        let stop=()=>{
            if(swipe_timer){
                clearInterval(swipe_timer);
                swipe_timer=null;
            }
        };
        // åˆå§‹åŒ?
        let init=()=>{
            for(let i=0;i<links.length;i++){
                // åˆ›å»ºaå…ƒç´ 
                let item=document.createElement('a');
                // ä¿®æ”¹å±æ€?
                item.setAttribute('class','item');
                item.setAttribute('href','#');
                item.setAttribute('data-index',i);
                // è¿½åŠ å…ƒç´ 
                swipe_select.appendChild(item);
            }
            // é»˜è®¤ç¬¬ä¸€å¼?
            select(0);
            // ç»‘å®šå„ä¸ªäº‹ä»¶å¹¶å¼€å§‹è½®æ’?
            bind();
            play();
        };
        // ç»‘å®š
        let bind=()=>{
            // å·¦ç¿»äº‹ä»¶ç›‘å¬
            swipe_btn_left.addEventListener('click',()=>{
                // è®¾ç½®æ–°çš„index
                let index=current_index-1;
                // å·¦ç¿»è¶Šç•Œï¼Œåˆ‡åˆ°æœ€åä¸€å¼?
                if(index<0){
                    index=links.length-1;
                }
                // åŠ è½½æ–°å›¾ç‰?
                select(index);
            });
            // å³ç¿»äº‹ä»¶ç›‘å¬
            swipe_btn_right.addEventListener('click',()=>{
                // è®¾ç½®æ–°çš„index
                let index=current_index+1;
                // å³ç¿»è¶Šç•Œï¼Œåˆ‡åˆ°ç¬¬ä¸€å¼?
                if(index>=links.length){
                    index=0;
                }
                // åŠ è½½æ–°å›¾ç‰?
                select(index);
            });
            // å¾ªç¯ç»‘å®šæŒ‡ç¤ºå™¨ç‚¹å‡»äº‹ä»?
            for(const key in swipe_select.children){
                if(swipe_select.children.hasOwnProperty(key)){
                    const element=swipe_select.children[key];
                    element.addEventListener('click',(e)=>{
                        // å–æ¶ˆé»˜è®¤ç‚¹å‡»è·³è½¬
                        e.preventDefault();
                        // è·³è½¬åˆ°å½“å‰æŒ‡ç¤ºç‚¹ä¸­data-indexæ‰€æŒ‡å®šçš„å›¾ç‰?
                        select(e.target.dataset.index);
                    });
                }
            }
            // ç»‘å®šé¼ æ ‡ç§»å…¥äº‹ä»¶
            swipe.addEventListener('mouseover',(e)=>{
                // é˜²æ­¢é¼ æ ‡ä»å­å…ƒç´ ç§»å‡ºæ—¶è§¦å?
                if(e.relatedTarget&&swipe.compareDocumentPosition(e.relatedTarget)==10){
                    stop();
                }
            });
            // ç»‘å®šé¼ æ ‡ç§»å‡ºäº‹ä»¶
            swipe.addEventListener('mouseout',(e)=>{
                // é˜²æ­¢é¼ æ ‡ä»å­å…ƒç´ ç§»å‡ºæ—¶è§¦å?
                if(e.relatedTarget&&swipe.compareDocumentPosition(e.relatedTarget)==10){
                    play();
                }
            });
            // ç»‘å®šé¼ æ ‡ç§»åŠ¨äº‹ä»¶
            swipe.addEventListener('mousemove',(e)=>{
                stop();
            });
        };

        // é¡µé¢åŠ è½½å®Œæ¯•ï¼Œæ‰§è¡Œåˆå§‹åŒ–
        window.addEventListener('load',()=>{
            init();
        })
    </script>
</body>

</html>